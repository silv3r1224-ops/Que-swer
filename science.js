// ========================
// Data for Science Papers
// ========================
const data = {
  "2023": {
    "Semester 1": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 2": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 3": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 4": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 5": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 6": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    }
  },
  "2024": {
    "Semester 1": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 2": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 3": {
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem3/2024/BSC/chem", prefix: "chem", totalPages: 11 }
      ],
      "Mathematics": [
        { name: "Calculus-I and Statistics", folder: "NEHU/NEP/sem3/2024/BSC/maths/calnstat", prefix: "calnstat", totalPages: 8 },
        { name: "Group Theory", folder: "NEHU/NEP/sem3/2024/BSC/maths/gt", prefix: "gt", totalPages: 4 }
      ],
      "Computer Science": [
        { name: "Object Oriented Java", folder: "NEHU/NEP/sem3/2024/BSC/Comp/Java", prefix: "java", totalPages: 4 },
        { name: "Computer Science", folder: "NEHU/NEP/sem3/2024/BSC/Comp", prefix: "comp", totalPages: 4 }
      ]
    },
    "Semester 4": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 5": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 6": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    }
  },
  "2025": {
    "Semester 1": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 2": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 3": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 4": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 5": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    },
    "Semester 6": {
      "Physics": [
        { name: "Physics", folder: "NEHU/NEP/sem1/2023/BSC/physics", prefix: "phy", totalPages: 5 }
      ],
      "Chemistry": [
        { name: "Chemistry", folder: "NEHU/NEP/sem1/2023/BSC/chem", prefix: "chem", totalPages: 6 }
      ]
    }
  }
};

// ========================
// Globals
// ========================
let currentYear = null;
let currentSemester = null;

const title = document.getElementById('step-title');
const options = document.getElementById('options');
const paperView = document.getElementById('paper-view');
const backBtn = document.getElementById('back-btn');

// ========================
// Navigation Helpers
// ========================
function showBack(action, isHome=false) {
  if (isHome) {
    backBtn.innerHTML = `<a href="../index.html" class="btn">⬅ Home</a>`;
  } else {
    backBtn.innerHTML = `<button class="btn" onclick="${action}">⬅ Back</button>`;
  }
}

// ========================
// Load Functions
// ========================
function loadYears() {
  title.textContent = "Select Year";
  options.innerHTML = "";
  paperView.innerHTML = "";
  showBack("", true);

  Object.keys(data).forEach(year => {
    createCard(year, () => {
      currentYear = year;
      loadSemesters(year);
    });
  });
}

function loadSemesters(year) {
  title.textContent = `Select Semester (${year})`;
  options.innerHTML = "";
  paperView.innerHTML = "";

  Object.keys(data[year]).forEach(sem => {
    createCard(sem, () => {
      currentSemester = sem;
      loadSubjects(year, sem);
    });
  });

  showBack("loadYears()");
}

function loadSubjects(year, semester) {
  title.textContent = `Select Subject (${semester}, ${year})`;
  options.innerHTML = "";
  paperView.innerHTML = "";

  Object.keys(data[year][semester]).forEach(subject => {
    createCard(subject, () => {
      loadPapers(year, semester, subject);
    });
  });

  showBack(`loadSemesters('${year}')`);
}

function loadPapers(year, semester, subject) {
  title.textContent = `Select Paper (${subject}, ${semester}, ${year})`;
  options.innerHTML = "";
  paperView.innerHTML = "";

  const papers = data[year][semester][subject];
  papers.forEach(paper => {
    createCard(paper.name, () => {
      loadPaperPages(year, semester, subject, paper);
    });
  });

  showBack(`loadSubjects('${year}','${semester}')`);
}

function loadPaperPages(year, semester, subject, paper) {
  title.textContent = `${paper.name} (${subject}, ${semester}, ${year})`;
  options.innerHTML = "";
  paperView.innerHTML = "";

  for (let i = 1; i <= paper.totalPages; i++) {
    let imgPath = `${paper.folder}/${paper.prefix}${i}.jpg`;
    let img = document.createElement("img");
    img.setAttribute("loading", "lazy");
    img.src = imgPath;
    img.alt = `${paper.name} Page ${i}`;
    paperView.appendChild(img);
  }

  showBack(`loadPapers('${year}','${semester}','${subject}')`);
}

// ========================
// Helpers
// ========================
function createCard(label, action) {
  const card = document.createElement('div');
  card.className = "card";
  card.textContent = label;
  card.onclick = action;
  options.appendChild(card);
}

// ========================
// Start App
// ========================
loadYears();
